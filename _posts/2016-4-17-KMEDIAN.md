---
layout: post
title:  "KMEDIAN - Above the Median"
categories: [binary-index-tree, binary-search, sortings]
code: KMEDIAN
src: KMEDIAN.cpp
---

Gọi f[i] là số lượng số >= k trong khoảng từ 1-> i thì số lượng các số >= k trong khoảng từ i->j là f[j]-f[i-1].

Thuật cơ sở :

for j=1->n
    for i=1->j
        kiểm tra xem đoạn i..j có thỏa mãn không :

Điều kiện thỏa mãn là :

m = j-i+1 (chiều dài dãy) và t = f[j]-f[i-1] là số lượng các số >= k
=> m-t là số lượng các số < k.

điều kiện để vị trí trung vị >= k chính là

t >= m-t
    => 2t >= m
    => 2f[j]-f[i-1] >= j-i+1
    => 2f[j]-j-1 >= 2f[i-1]-i (*)


Đến đây thì chỉ việc dùng BIT để đếm và cập nhật các số thỏa (*). Mặc dù các số có giá trị < 2n nhưng có số âm nên phải nén số lại và chặt nhị phân tìm kiếm vị trí trên BIT