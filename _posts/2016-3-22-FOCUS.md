---
layout: post
title:  "FOCUS - Chuyên gia ruồi"
categories: [binary-search, binary-index-tree, sortings]
code: FOCUS
src: FOCUS.cpp
---

với mỗi truy vấn k a b, đếm số lượng ruồi từ a->b, nếu < k thì xuất ra 0. Trái lại, nhận xét rằng khi b tăng dần thì số ruồi cũng tăng dần, do đó chặt nhị phân tuổi của của ruồi trong đoạn a,b tìm tuổi đầu tiên, gọi là x (chú ý là nhỏ nhất, vì nếu sơ sót sẽ tìm nhầm những tuổi lớn hơn) sao cho k <= số ruồi trong đoạn a,x. Do đó thuật có ĐPT là O(N x logN x logN).

Để tìm số ruồi trong đoạn l,r ta tính số ruồi <= r – số ruồi <= l-1, do số lớn nên nén số lại.

Vận dụng bài http://vn.spoj.com/problems/KKDD/ xem phần quy hoạch động