---
layout: post
title:  "QBPAL - Đếm chuỗi đối xứng"
categories: [bignum, dp]
code: QBPAL
src: QBPAL.cpp
---

Gọi `F[i][j]` là số con đối xứng của đoạn i-j. 

Nếu i = j thì F[i][j] = 1.

Nếu i = j-1:  nếu s[i] = s[j] (ví dụ II) thì F[i][j] = 3, else F[i][j] = 2

Nếu i < j-1 thì : F[i][j] hình thành từ i,j-1 với i+1,j. Nhưng có thể ở hai lần tính này tính hai lần cho các xâu nằm trong i+1,j-1 (tức là không đả động gì đến hai phần tử biên), do đó trừ đi một lần đoạn i+1,j-1.

Tức là `F[i][j] = F[i+1][j] + F[i][j-1] – F[i+1][j-1]`.

Sau đó, trong trường hợp s[i] = s[j] (tức là I…AIDS…I chẳng hạn) thì sẽ hình thành thêm : trước hết là xâu tạo bởi hai phần tử này (II). Thứ hai, Các xâu trong đoạn i+1,j-1 lại được tạo mới do hai phần tử này góp vào.

Do đó `F[i][j] += F[i+j][j-1] + 1`

Cài số lớn
