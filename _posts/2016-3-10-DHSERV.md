---
layout: post
title:  "DHSERV - Dịch vụ truyền thông"
categories: [dijkstra]
code: DHSERV
src: DHSERV.cpp
---

Nhìn giới hạn `k` khá lớn nhưng để ý kĩ thì số lượng truy vấn 1 chỉ tối đa là `N`, do đó tại mỗi truy vấn 1 ta lại dijkstra heap N đỉnh một lần, do đó tại mỗi truy vấn 2 thì chỉ việc xuất ra `d[u][v]` mà thôi, với `d[u][v]` là đường đi ngắn nhất từ `u` tới `v` và `d[u][v] = inf` nếu không có đường. Tạo thêm mảng `dd[u]` tức là `u` đã kích hoạt hay chưa.

Lưu ý tại thủ tục dijkstra thì chỉ đẩy vào heap những đỉnh đã kích hoạt, còn những đỉnh chưa kích hoạt thì phải cập nhật bình thường, không bỏ qua. Còn lệnh `d[s][v] > d[s][u] + c[u][v]` thì phải sửa lại thành `d[s][v] >= d[s][u] + c[u][v]`, có thêm dấu bằng vì nếu như v đã kích hoạt thì còn đẩy nó vào để update những đứa khác.

ĐPT có vẻ khá lớn, `O(K + N^3.log(N) + N.M)`, nhưng đủ cho ta AC.
